#!/bin/sh

PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin

set_color_name() {
  local HOST=$1
  local HEX_FG=$2
  local HEX_BG=$3
  local OPACITY=$4

  local FG_R=`echo $HEX_FG | sed 's/../0x&,/g' | awk -F "," '{printf("%d",$1 * 257)}'`
  local FG_G=`echo $HEX_FG | sed 's/../0x&,/g' | awk -F "," '{printf("%d",$2 * 257)}'`
  local FG_B=`echo $HEX_FG | sed 's/../0x&,/g' | awk -F "," '{printf("%d",$3 * 257)}'`
  local BG_R=`echo $HEX_BG | sed 's/../0x&,/g' | awk -F "," '{printf("%d",$1 * 257)}'`
  local BG_G=`echo $HEX_BG | sed 's/../0x&,/g' | awk -F "," '{printf("%d",$2 * 257)}'`
  local BG_B=`echo $HEX_BG | sed 's/../0x&,/g' | awk -F "," '{printf("%d",$3 * 257)}'`

  /usr/bin/osascript <<EOF
tell application "iTerm"
   tell current session of current terminal
      set name to "$HOST"
      set foreground color to {$FG_R, $FG_G, $FG_B}
      set background color to {$BG_R, $BG_G, $BG_B}
      set transparency to "$OPACITY"
   end tell
end tell
EOF
}

## colors
red="fa053e"
orange="fa6b05"
yellow="dedb86"
green="1c6928"
dgreen="064a10"
dblue="1a2261"
blue="054cf2"
cyan="3beaf6"
purple="973bcc"
lpurple="eb5bd5"
pink="f213d5"
brown="542323"
black="000000"
white="ffffff"

## opacities
opaque=0.0

## envs
trunk_fg=$blue;     trunk_bg=$black
release_fg=$yellow; release_bg=$black
automate_fg=$red;   automate_bg=$black

## infra
ace_fg=$white;       ace_bg=$purple
byss_fg=$red;        byss_bg=$black
callisto_fg=$white;  callisto_bg=$pink
corellia_fg=$red;    corellia_bg=$black
gambit_fg=$white;    gambit_bg=$purple
gary_fg=$black;      gary_bg=$purple
hulk_fg=$black;      hulk_bg=$green
kitt_fg=$black;      kitt_bg=$white
magneto_fg=$white;   magneto_bg=$black
nermal_fg=$white;    nermal_bg=$cyan
otrs_fg=$black;      otrs_bg=$white
rogue_fg=$yellow;    rogue_bg=$purple
thing_fg=$white;     thing_bg=$lpurple
quicksilver_fg=$black; quicksilver_bg=$brown
chef_bg=$black;      chef_fg=$green

## offsite
nyc_bg=$cyan;    nyc_fg=$black

## prod
# lb
coruscant_fg=$yellow; coruscant_bg=$black
hoth_fg=$yellow     ; hoth_bg=$black
# app
endor_fg=$white;    endor_bg=$blue
naboo_fg=$white;    naboo_bg=$blue
iego_fg=$white;     iego_bg=$blue
yavin_fg=$white;    yavin_bg=$blue
dagobah_fg=$white;  dagobah_bg=$blue
tatooine_fg=$white; tatooine_bg=$dblue
# job
bothan_fg=$white;   bothan_bg=$brown
kessel_fg=$black;   kessel_bg=$brown
# mysql db
mystique_fg=$white;   mystique_bg=$red
azazel_fg=$white;     azazel_bg=$orange
sabertooth_fg=$white; sabertooth_bg=$yellow
# cde db
vulcan_fg=$white;     vulcan_bg=$red
corsair_fg=$white;    corsair_bg=$orange
havok_fg=$white;      havok_bg=$yellow
# redis/memcache
superman_fg=$white;    superman_bg=$pink
wonderwoman_fg=$black; wonderwoman_bg=$black

# pgsql
ironman_fg=$white; ironman_bg=$orange
bionicwoman_fg=$black; bionicwoman_bg=$orange
# mk/xds/acc/shed
cloak_fg=$black;    cloak_bg=$white
dagger_fg=$red;  dagger_bg=$white
# nfs
dream_fg=$black; dream_bg=$green
# pimvpn
thor_fg=$black; thor_bg=$dblue

# office non windows infra
#spout
#bruinen
#eriador

# free
hobbes_fg=$white; hobbes_bg=$dgreen
phoenix_fg=$white; phoenix_bg=$dgreen
rorschach_fg=$white; rorschach_bg=$dgreen
storm_fg=$white; storm_bg=$dgreen

# networking
gwdca1_fg=$white; gwdca1_bg=$pink
gwhq_fg=$black;  gwhq_bg=$pink

# me
philip_fg=$purple; philip_bg=$black

ssh_args=

## Args
case $1 in
  gwdca1)
   host=192.168.0.1
   Thost=$1
   ;;
  gwhq)
   host=172.24.1.1
   Thost=$1
   ;;
  chef)
   host=10.240.2.161
   ssh_args="-i repos/rws/devops-chef/.chef/bootstrap.pem -l ubuntu"
   Thost=$1
   ;;
  *)
   host=$1
   Thost=$(echo $host |sed -e 's,\.,_,g')
   ;;
esac

## Magic
eval fg=\$${Thost}_fg
eval bg=\$${Thost}_bg

## DO-IT!

case $host in
  abomination|dococ|dolamroth|doriath|erebor|gondolin|gondolin|isengard|minastirith|nargothrond|osgilath|pimkins|rivendell|rohan|shire|vcenter)
   rdesktop -g 1024x768 -u $USER -d HQRWS $host
   ;;
  *)
   set_color_name $host $fg $bg $opaque
   ssh $ssh_args $host
   set_color_name $host $white $black 0.0
   ;;
esac
